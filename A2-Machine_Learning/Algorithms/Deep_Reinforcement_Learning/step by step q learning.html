
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Step By Step Q Learning · CharlesNotes</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="Charles Xu">
        
        
    
    <link rel="stylesheet" href="../../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-katex/katex.min.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-disqus/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../../gitbook/images/favicon.ico" type="image/x-icon">

    
    
    <link rel="prev" href="OU-process.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../../">
            
                <a href="../../../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <span>
            
                    
                    A 0 Mathmatics
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../../../A0-Mathmatics/attractor.py.html">
            
                <a href="../../../A0-Mathmatics/attractor.py.html">
            
                    
                    attractor.py
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                    A 1 Computer Science
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" >
            
                <span>
            
                    
                    Algorithm
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1.1" data-path="../../../A1-Computer_Science/Algorithm/Bit_Manipulation.html">
            
                <a href="../../../A1-Computer_Science/Algorithm/Bit_Manipulation.html">
            
                    
                    Bit Manipulation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.2" data-path="../../../A1-Computer_Science/Algorithm/Calculator_AST.py.html">
            
                <a href="../../../A1-Computer_Science/Algorithm/Calculator_AST.py.html">
            
                    
                    Calculator_AST.py
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.3" data-path="../../../A1-Computer_Science/Algorithm/DFS-BFS.html">
            
                <a href="../../../A1-Computer_Science/Algorithm/DFS-BFS.html">
            
                    
                    DFS BFS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.4" data-path="../../../A1-Computer_Science/Algorithm/Diffie_Hellman_Key_Exchange.html">
            
                <a href="../../../A1-Computer_Science/Algorithm/Diffie_Hellman_Key_Exchange.html">
            
                    
                    Diffie Hellman Key Exchange
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.5" data-path="../../../A1-Computer_Science/Algorithm/Dynamic_Programming.html">
            
                <a href="../../../A1-Computer_Science/Algorithm/Dynamic_Programming.html">
            
                    
                    Dynamic Programming
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.6" data-path="../../../A1-Computer_Science/Algorithm/Eight_Queen.py.html">
            
                <a href="../../../A1-Computer_Science/Algorithm/Eight_Queen.py.html">
            
                    
                    Eight_Queen.py
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.7" data-path="../../../A1-Computer_Science/Algorithm/FullBinaryTreeHeap.py.html">
            
                <a href="../../../A1-Computer_Science/Algorithm/FullBinaryTreeHeap.py.html">
            
                    
                    FullBinaryTreeHeap.py
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.8" data-path="../../../A1-Computer_Science/Algorithm/sort.py.html">
            
                <a href="../../../A1-Computer_Science/Algorithm/sort.py.html">
            
                    
                    sort.py
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.9" data-path="../../../A1-Computer_Science/Algorithm/swap.html">
            
                <a href="../../../A1-Computer_Science/Algorithm/swap.html">
            
                    
                    Swap
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2" >
            
                <span>
            
                    
                    Programming
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.1" >
            
                <span>
            
                    
                    Front End
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.1.1" >
            
                <span>
            
                    
                    HTML
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.1.1.1" data-path="../../../A1-Computer_Science/Programming/Front_End/HTML/split panes.html.html">
            
                <a href="../../../A1-Computer_Science/Programming/Front_End/HTML/split panes.html.html">
            
                    
                    split panes.html
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2.1.2" >
            
                <span>
            
                    
                    热力图
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.1.2.1" data-path="../../../A1-Computer_Science/Programming/Front_End/热力图/FrontEnd.html.html">
            
                <a href="../../../A1-Computer_Science/Programming/Front_End/热力图/FrontEnd.html.html">
            
                    
                    FrontEnd.html
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.1.2.2" data-path="../../../A1-Computer_Science/Programming/Front_End/热力图/百度api获取城市坐标.py.html">
            
                <a href="../../../A1-Computer_Science/Programming/Front_End/热力图/百度api获取城市坐标.py.html">
            
                    
                    百度api获取城市坐标.py
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2.2" >
            
                <span>
            
                    
                    Language
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.2.1" data-path="../../../A1-Computer_Science/Programming/Language/C++/">
            
                <a href="../../../A1-Computer_Science/Programming/Language/C++/">
            
                    
                    C
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.2.1.1" >
            
                <span>
            
                    
                    Gramma
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.2.1.1.1" data-path="../../../A1-Computer_Science/Programming/Language/C++/Gramma/argv.cc.html">
            
                <a href="../../../A1-Computer_Science/Programming/Language/C++/Gramma/argv.cc.html">
            
                    
                    argv.cc
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2.1.1.2" data-path="../../../A1-Computer_Science/Programming/Language/C++/Gramma/inherit.cc.html">
            
                <a href="../../../A1-Computer_Science/Programming/Language/C++/Gramma/inherit.cc.html">
            
                    
                    inherit.cc
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2.2.1.2" data-path="../../../A1-Computer_Science/Programming/Language/C++/STL/">
            
                <a href="../../../A1-Computer_Science/Programming/Language/C++/STL/">
            
                    
                    STL
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2.2.2" >
            
                <span>
            
                    
                    Python
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.2.2.1" >
            
                <span>
            
                    
                    Dev Tools
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.2.2.1.1" data-path="../../../A1-Computer_Science/Programming/Language/Python/DevTools/crash_on_ipy.py.html">
            
                <a href="../../../A1-Computer_Science/Programming/Language/Python/DevTools/crash_on_ipy.py.html">
            
                    
                    crash_on_ipy.py
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2.2.1.2" data-path="../../../A1-Computer_Science/Programming/Language/Python/DevTools/jupyter_hide_code.py.html">
            
                <a href="../../../A1-Computer_Science/Programming/Language/Python/DevTools/jupyter_hide_code.py.html">
            
                    
                    jupyter_hide_code.py
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2.2.2.2" >
            
                <span>
            
                    
                    Example
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.2.2.2.1" data-path="../../../A1-Computer_Science/Programming/Language/Python/Example/sendmail/">
            
                <a href="../../../A1-Computer_Science/Programming/Language/Python/Example/sendmail/">
            
                    
                    Sendmail
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.2.2.2.1.1" data-path="../../../A1-Computer_Science/Programming/Language/Python/Example/sendmail/attachment.py.html">
            
                <a href="../../../A1-Computer_Science/Programming/Language/Python/Example/sendmail/attachment.py.html">
            
                    
                    attachment.py
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2.2.2.1.2" data-path="../../../A1-Computer_Science/Programming/Language/Python/Example/sendmail/pic.py.html">
            
                <a href="../../../A1-Computer_Science/Programming/Language/Python/Example/sendmail/pic.py.html">
            
                    
                    pic.py
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2.2.2.1.3" data-path="../../../A1-Computer_Science/Programming/Language/Python/Example/sendmail/qq_smtp.py.html">
            
                <a href="../../../A1-Computer_Science/Programming/Language/Python/Example/sendmail/qq_smtp.py.html">
            
                    
                    qq_smtp.py
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2.2.2.1.4" data-path="../../../A1-Computer_Science/Programming/Language/Python/Example/sendmail/sendmail.py.html">
            
                <a href="../../../A1-Computer_Science/Programming/Language/Python/Example/sendmail/sendmail.py.html">
            
                    
                    sendmail.py
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2.2.2.2.2" data-path="../../../A1-Computer_Science/Programming/Language/Python/Example/argparse_example.py.html">
            
                <a href="../../../A1-Computer_Science/Programming/Language/Python/Example/argparse_example.py.html">
            
                    
                    argparse_example.py
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2.2.2.3" data-path="../../../A1-Computer_Science/Programming/Language/Python/Example/ctypes.html">
            
                <a href="../../../A1-Computer_Science/Programming/Language/Python/Example/ctypes.html">
            
                    
                    Ctypes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2.2.2.4" data-path="../../../A1-Computer_Science/Programming/Language/Python/Example/cython.html">
            
                <a href="../../../A1-Computer_Science/Programming/Language/Python/Example/cython.html">
            
                    
                    Cython
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2.2.2.5" data-path="../../../A1-Computer_Science/Programming/Language/Python/Example/keyboard-mouse.html">
            
                <a href="../../../A1-Computer_Science/Programming/Language/Python/Example/keyboard-mouse.html">
            
                    
                    Keyboard Mouse
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2.2.2.6" data-path="../../../A1-Computer_Science/Programming/Language/Python/Example/ncurses_example.py.html">
            
                <a href="../../../A1-Computer_Science/Programming/Language/Python/Example/ncurses_example.py.html">
            
                    
                    ncurses_example.py
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2.2.2.7" data-path="../../../A1-Computer_Science/Programming/Language/Python/Example/pandas.html">
            
                <a href="../../../A1-Computer_Science/Programming/Language/Python/Example/pandas.html">
            
                    
                    Pandas
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2.2.2.8" data-path="../../../A1-Computer_Science/Programming/Language/Python/Example/qrcode_example.py.html">
            
                <a href="../../../A1-Computer_Science/Programming/Language/Python/Example/qrcode_example.py.html">
            
                    
                    qrcode_example.py
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2.2.2.9" data-path="../../../A1-Computer_Science/Programming/Language/Python/Example/socket.html">
            
                <a href="../../../A1-Computer_Science/Programming/Language/Python/Example/socket.html">
            
                    
                    Socket
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2.2.2.10" data-path="../../../A1-Computer_Science/Programming/Language/Python/Example/动态修改幻灯片内容.html">
            
                <a href="../../../A1-Computer_Science/Programming/Language/Python/Example/动态修改幻灯片内容.html">
            
                    
                    动态修改幻灯片内容
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2.2.3" data-path="../../../A1-Computer_Science/Programming/Language/Regular Expression.html">
            
                <a href="../../../A1-Computer_Science/Programming/Language/Regular Expression.html">
            
                    
                    Regular Expression
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2.3" >
            
                <span>
            
                    
                    Software Engineering
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.3.1" data-path="../../../A1-Computer_Science/Programming/Software_Engineering/Design/">
            
                <a href="../../../A1-Computer_Science/Programming/Software_Engineering/Design/">
            
                    
                    Design
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.3.1.1" data-path="../../../A1-Computer_Science/Programming/Software_Engineering/Design/Factory_Pattern.html">
            
                <a href="../../../A1-Computer_Science/Programming/Software_Engineering/Design/Factory_Pattern.html">
            
                    
                    Factory Pattern
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2.4" data-path="../../../A1-Computer_Science/Programming/Learning.html">
            
                <a href="../../../A1-Computer_Science/Programming/Learning.html">
            
                    
                    Learning
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" >
            
                <span>
            
                    
                    A 2 Machine Learning
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" >
            
                <span>
            
                    
                    Algorithms
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1.1" data-path="./">
            
                <a href="./">
            
                    
                    Deep Reinforcement Learning
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1.1.1" >
            
                <span>
            
                    
                    Policy Gradient
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1.1.1.1" data-path="Policy_Gradient/karpathy-pg-pong.py.html">
            
                <a href="Policy_Gradient/karpathy-pg-pong.py.html">
            
                    
                    karpathy-pg-pong.py
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.1.1.2" data-path="Policy_Gradient/kvfrans-ddpg.py.html">
            
                <a href="Policy_Gradient/kvfrans-ddpg.py.html">
            
                    
                    kvfrans-ddpg.py
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.1.1.3" data-path="Policy_Gradient/my simple PG.py.html">
            
                <a href="Policy_Gradient/my simple PG.py.html">
            
                    
                    my simple PG.py
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.1.1.4" data-path="Policy_Gradient/replay_buffer.py.html">
            
                <a href="Policy_Gradient/replay_buffer.py.html">
            
                    
                    replay_buffer.py
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.1.1.2" data-path="Fine Tuning.html">
            
                <a href="Fine Tuning.html">
            
                    
                    Fine Tuning
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.1.3" data-path="OU-process.html">
            
                <a href="OU-process.html">
            
                    
                    OU Process
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.4.1.1.4" data-path="step by step q learning.html">
            
                <a href="step by step q learning.html">
            
                    
                    Step By Step Q Learning
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.1.2" >
            
                <span>
            
                    
                    Neural Network
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1.2.1" data-path="../NeuralNetwork/nn_mnist_static.py.html">
            
                <a href="../NeuralNetwork/nn_mnist_static.py.html">
            
                    
                    nn_mnist_static.py
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.2.2" data-path="../NeuralNetwork/nn_mnist.py.html">
            
                <a href="../NeuralNetwork/nn_mnist.py.html">
            
                    
                    nn_mnist.py
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.1.3" >
            
                <span>
            
                    
                    Support Vector Machine
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1.3.1" data-path="../SupportVectorMachine/SMO_Simple.html">
            
                <a href="../SupportVectorMachine/SMO_Simple.html">
            
                    
                    SMO Simple
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.1.4" data-path="../LDA.py.html">
            
                <a href="../LDA.py.html">
            
                    
                    LDA.py
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.2" >
            
                <span>
            
                    
                    Problems
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.2.1" data-path="../../Problems/Imbalance.html">
            
                <a href="../../Problems/Imbalance.html">
            
                    
                    Imbalance
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.3" >
            
                <span>
            
                    
                    Tools
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.3.1" data-path="../../Tools/PyTorch/">
            
                <a href="../../Tools/PyTorch/">
            
                    
                    Py Torch
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.3.1.1" data-path="../../Tools/PyTorch/Example.html">
            
                <a href="../../Tools/PyTorch/Example.html">
            
                    
                    Example
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.3.2" >
            
                <span>
            
                    
                    Sci Kit Learn
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.3.2.1" data-path="../../Tools/SciKit-Learn/tsne.py.html">
            
                <a href="../../Tools/SciKit-Learn/tsne.py.html">
            
                    
                    tsne.py
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.3.3" data-path="../../Tools/TensorFlow/">
            
                <a href="../../Tools/TensorFlow/">
            
                    
                    Tensor Flow
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.3.3.1" >
            
                <span>
            
                    
                    Tensor Board
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.3.3.1.1" data-path="../../Tools/TensorFlow/TensorBoard/mnist_with_summaries.py.html">
            
                <a href="../../Tools/TensorFlow/TensorBoard/mnist_with_summaries.py.html">
            
                    
                    mnist_with_summaries.py
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.3.1.2" data-path="../../Tools/TensorFlow/TensorBoard/tensorboard_advanced.py.html">
            
                <a href="../../Tools/TensorFlow/TensorBoard/tensorboard_advanced.py.html">
            
                    
                    tensorboard_advanced.py
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.3.3.2" data-path="../../Tools/TensorFlow/1-TensorFlow Cheatsheet.html">
            
                <a href="../../Tools/TensorFlow/1-TensorFlow Cheatsheet.html">
            
                    
                    1 Tensor Flow Cheatsheet
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.3.3" data-path="../../Tools/TensorFlow/Distributed_tensorflow.py.html">
            
                <a href="../../Tools/TensorFlow/Distributed_tensorflow.py.html">
            
                    
                    Distributed_tensorflow.py
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.3.4" data-path="../../Tools/TensorFlow/Duplicate_a_tensorflow_graph.html">
            
                <a href="../../Tools/TensorFlow/Duplicate_a_tensorflow_graph.html">
            
                    
                    Duplicate A Tensorflow Graph
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" >
            
                <span>
            
                    
                    A 3 Linux
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../../../A3-Linux/Bash/">
            
                <a href="../../../A3-Linux/Bash/">
            
                    
                    Bash
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1.1" data-path="../../../A3-Linux/Bash/bash的高级技巧.html">
            
                <a href="../../../A3-Linux/Bash/bash的高级技巧.html">
            
                    
                    bash的高级技巧
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.2" >
            
                <span>
            
                    
                    Server Maintenance
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.2.1" data-path="../../../A3-Linux/Server_Maintenance/scripts/">
            
                <a href="../../../A3-Linux/Server_Maintenance/scripts/">
            
                    
                    Scripts
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.2.1.1" data-path="../../../A3-Linux/Server_Maintenance/scripts/backup_server_data.py.html">
            
                <a href="../../../A3-Linux/Server_Maintenance/scripts/backup_server_data.py.html">
            
                    
                    backup_server_data.py
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.1.2" data-path="../../../A3-Linux/Server_Maintenance/scripts/charles-adduser.sh.html">
            
                <a href="../../../A3-Linux/Server_Maintenance/scripts/charles-adduser.sh.html">
            
                    
                    charles-adduser.sh
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.1.3" data-path="../../../A3-Linux/Server_Maintenance/scripts/mv2cron.bash.html">
            
                <a href="../../../A3-Linux/Server_Maintenance/scripts/mv2cron.bash.html">
            
                    
                    mv2cron.bash
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.1.4" data-path="../../../A3-Linux/Server_Maintenance/scripts/sendlog.py.html">
            
                <a href="../../../A3-Linux/Server_Maintenance/scripts/sendlog.py.html">
            
                    
                    sendlog.py
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.2.2" data-path="../../../A3-Linux/Server_Maintenance/AUTO_UPGRADE.html">
            
                <a href="../../../A3-Linux/Server_Maintenance/AUTO_UPGRADE.html">
            
                    
                    AUTO UPGRADE
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.3" data-path="../../../A3-Linux/Server_Maintenance/QUOTA.html">
            
                <a href="../../../A3-Linux/Server_Maintenance/QUOTA.html">
            
                    
                    QUOTA
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.4" data-path="../../../A3-Linux/Server_Maintenance/SECURITY.html">
            
                <a href="../../../A3-Linux/Server_Maintenance/SECURITY.html">
            
                    
                    SECURITY
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../../../A3-Linux/Arch Linux Installation.html">
            
                <a href="../../../A3-Linux/Arch Linux Installation.html">
            
                    
                    Arch Linux Installation
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" >
            
                <span>
            
                    
                    B Economics
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../../../B-Economics/Principle/">
            
                <a href="../../../B-Economics/Principle/">
            
                    
                    Principle
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" >
            
                <span>
            
                    
                    Quantitative Investment
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.2.1" data-path="../../../B-Economics/Quantitative_Investment/基本概念.html">
            
                <a href="../../../B-Economics/Quantitative_Investment/基本概念.html">
            
                    
                    基本概念
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" >
            
                <span>
            
                    
                    B Management
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" >
            
                <span>
            
                    
                    Human Resource
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1.1" data-path="../../../B-Management/HumanResource/Interview/">
            
                <a href="../../../B-Management/HumanResource/Interview/">
            
                    
                    Interview
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1.1.1" data-path="../../../B-Management/HumanResource/Interview/2018ST实习收获.html">
            
                <a href="../../../B-Management/HumanResource/Interview/2018ST实习收获.html">
            
                    
                    2018ST实习收获
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.1.1.2" data-path="../../../B-Management/HumanResource/Interview/2020面试总结.html">
            
                <a href="../../../B-Management/HumanResource/Interview/2020面试总结.html">
            
                    
                    2020面试总结
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.1.1.3" data-path="../../../B-Management/HumanResource/Interview/Inwerviewer.html">
            
                <a href="../../../B-Management/HumanResource/Interview/Inwerviewer.html">
            
                    
                    Inwerviewer
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../../../B-Management/ManagementByObject/">
            
                <a href="../../../B-Management/ManagementByObject/">
            
                    
                    Management By Object
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.2.1" data-path="../../../B-Management/ManagementByObject/OKR.html">
            
                <a href="../../../B-Management/ManagementByObject/OKR.html">
            
                    
                    OKR
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2.2" data-path="../../../B-Management/ManagementByObject/Self-Control.html">
            
                <a href="../../../B-Management/ManagementByObject/Self-Control.html">
            
                    
                    Self Control
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2.3" data-path="../../../B-Management/ManagementByObject/SMART.html">
            
                <a href="../../../B-Management/ManagementByObject/SMART.html">
            
                    
                    SMART
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../../../C-Traffic_Control/">
            
                <a href="../../../C-Traffic_Control/">
            
                    
                    C Traffic Control
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="../../../C-Traffic_Control/Objects.html">
            
                <a href="../../../C-Traffic_Control/Objects.html">
            
                    
                    Objects
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="../../../C-Traffic_Control/Terms.html">
            
                <a href="../../../C-Traffic_Control/Terms.html">
            
                    
                    Terms
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" >
            
                <span>
            
                    
                    X Photography
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="../../../X-Photography/1-纽约摄影学院三原则.html">
            
                <a href="../../../X-Photography/1-纽约摄影学院三原则.html">
            
                    
                    1-纽约摄影学院三原则
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../../../Y-Academic/">
            
                <a href="../../../Y-Academic/">
            
                    
                    Y Academic
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1" data-path="../../../Y-Academic/论文写作.html">
            
                <a href="../../../Y-Academic/论文写作.html">
            
                    
                    论文写作
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.2" data-path="../../../Y-Academic/论文阅读.html">
            
                <a href="../../../Y-Academic/论文阅读.html">
            
                    
                    论文阅读
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11" >
            
                <span>
            
                    
                    Z Sundry
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.1" data-path="../../../Z-Sundry/DPT-RP1 Config.html">
            
                <a href="../../../Z-Sundry/DPT-RP1 Config.html">
            
                    
                    DPT RP 1 Config
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../../.." >Step By Step Q Learning</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="painless-q-learning">painless q learning</h1>
<p>&#x673A;&#x5668;&#x4EBA;&#x5BFB;&#x8DEF;&#xFF0C;&#x76EE;&#x6807;&#x4E3A;&#x8D70;&#x5230;&#x6237;&#x5916;&#xFF08;5&#xFF09;</p>
<p>&#x539F;&#x6587;&#x94FE;&#x63A5;&#xFF1A;<a href="http://mnemstudio.org/path-finding-q-learning-tutorial.htm" target="_blank">http://mnemstudio.org/path-finding-q-learning-tutorial.htm</a></p>
<p>&#x5730;&#x56FE;&#xFF1A;</p>
<p><img src="agent_clip_image002.gif" alt="image.png"></p>
<p>&#x56FE;&#x6A21;&#x578B;&#xFF1A;</p>
<p><img src="map1a.gif" alt="image.png"></p>
<p>&#x56DE;&#x62A5;&#x7684;&#x77E9;&#x9635;&#x8868;&#x793A;&#xFF1A;</p>
<p><img src="r_matrix1.gif" alt="r"></p>
<p>The Q-Learning algorithm goes as follows:</p>
<ol>
<li><p>Set the gamma parameter, and environment rewards in matrix R.</p>
</li>
<li><p>Initialize matrix Q to zero.</p>
</li>
<li><p>For each episode:</p>
<p> Select a random initial state.</p>
<p> Do While the goal state hasn&apos;t been reached.</p>
<ul>
<li>Select one among all possible actions for the current state.</li>
<li>Using this possible action, consider going to the next state.</li>
<li>Get maximum Q value for this next state based on all possible actions.</li>
<li>Compute: Q(state, action) = R(state, action) + Gamma * Max[Q(next state, all actions)]</li>
<li>Set the next state as the current state.</li>
</ul>
</li>
</ol>
<pre><code>End Do
</code></pre><p>End For</p>
<pre><code class="lang-python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> random
</code></pre>
<pre><code class="lang-python">q = np.zeros([<span class="hljs-number">6</span>,<span class="hljs-number">6</span>])
r = np.array([[<span class="hljs-number">-1</span>,<span class="hljs-number">-1</span>,<span class="hljs-number">-1</span>,<span class="hljs-number">-1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">-1</span>],
            [<span class="hljs-number">-1</span>,<span class="hljs-number">-1</span>,<span class="hljs-number">-1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">-1</span>,<span class="hljs-number">100</span>],
            [<span class="hljs-number">-1</span>,<span class="hljs-number">-1</span>,<span class="hljs-number">-1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">-1</span>,<span class="hljs-number">-1</span>],
            [<span class="hljs-number">-1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">-1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">-1</span>],
            [<span class="hljs-number">0</span>,<span class="hljs-number">-1</span>,<span class="hljs-number">-1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">-1</span>,<span class="hljs-number">100</span>],
            [<span class="hljs-number">-1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">-1</span>,<span class="hljs-number">-1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">100</span>],
           ])
print(<span class="hljs-string">&apos;q=&apos;</span>, q, <span class="hljs-string">&apos;&apos;</span>, <span class="hljs-string">&apos;r=&apos;</span>, r, sep=<span class="hljs-string">&apos;\n&apos;</span>)
gamma = <span class="hljs-number">0.8</span>
print(<span class="hljs-string">&apos;\ngamma=&apos;</span>, gamma)
</code></pre>
<pre><code>q=
[[ 0.  0.  0.  0.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.]]

r=
[[ -1  -1  -1  -1   0  -1]
 [ -1  -1  -1   0  -1 100]
 [ -1  -1  -1   0  -1  -1]
 [ -1   0   0  -1   0  -1]
 [  0  -1  -1   0  -1 100]
 [ -1   0  -1  -1   0 100]]

gamma= 0.8
</code></pre><p>Look at the second row (state 1) of matrix R.  There are two possible actions for the current state 1: go to state 3, or go to state 5. By random selection, we select to go to 5 as our action.</p>
<p>Now let&apos;s imagine what would happen if our agent were in state 5.  Look at the sixth row of the reward matrix R (i.e. state 5).  It has 3 possible actions: go to state 1, 4 or 5.</p>
<p>Q(state, action) = R(state, action) + Gamma * Max[Q(next state, all actions)]</p>
<p>Q(1, 5) = R(1, 5) + 0.8 * Max[Q(5, 1), Q(5, 4), Q(5, 5)] = 100 + 0.8 * 0 = 100</p>
<p>Since matrix Q is still initialized to zero, Q(5, 1), Q(5, 4), Q(5, 5), are all zero.  The result of this computation for Q(1, 5) is 100 because of the instant reward from R(5, 1).</p>
<p>The next state, 5, now becomes the current state.  Because 5 is the goal state, we&apos;ve finished one episode.  Our agent&apos;s brain now contains an updated matrix Q as:</p>
<p><img src="q_matrix2.gif" alt="image.png"></p>
<p>For the next episode, we start with a randomly chosen initial state.  This time, we have state 3 as our initial state.</p>
<p>Look at the fourth row of matrix R; it has 3 possible actions: go to state 1, 2 or 4.  By random selection, we select to go to state 1 as our action.</p>
<p>Now we imagine that we are in state 1.  Look at the second row of reward matrix R (i.e. state 1).  It has 2 possible actions: go to state 3 or state 5.  Then, we compute the Q value:</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Q</mi><mo>(</mo><mi>s</mi><mi>t</mi><mi>a</mi><mi>t</mi><mi>e</mi><mo separator="true">,</mo><mi>a</mi><mi>c</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo>)</mo><mo>=</mo><mi>R</mi><mo>(</mo><mi>s</mi><mi>t</mi><mi>a</mi><mi>t</mi><mi>e</mi><mo separator="true">,</mo><mi>a</mi><mi>c</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo>)</mo><mo>+</mo><mi>&#x3B3;</mi><mo>&#xD7;</mo><mi>M</mi><mi>a</mi><mi>x</mi><mo>[</mo><mi>Q</mi><mo>(</mo><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi><mi>s</mi><mi>t</mi><mi>a</mi><mi>t</mi><mi>e</mi><mo separator="true">,</mo><mi>a</mi><mi>l</mi><mi>l</mi><mi>a</mi><mi>c</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mi>s</mi><mo>)</mo><mo>]</mo></mrow><annotation encoding="application/x-tex">Q(state, action) = R(state, action) + \gamma \times Max[Q(next state, all actions)]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">Q</span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mord mathit">t</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">e</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mord mathit">c</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathit">n</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mord mathit">t</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">e</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mord mathit">c</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathit">n</span><span class="mclose">)</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.05556em;">&#x3B3;</span><span class="mbin">&#xD7;</span><span class="mord mathit" style="margin-right:0.10903em;">M</span><span class="mord mathit">a</span><span class="mord mathit">x</span><span class="mopen">[</span><span class="mord mathit">Q</span><span class="mopen">(</span><span class="mord mathit">n</span><span class="mord mathit">e</span><span class="mord mathit">x</span><span class="mord mathit">t</span><span class="mord mathit">s</span><span class="mord mathit">t</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">e</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">a</span><span class="mord mathit">c</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathit">n</span><span class="mord mathit">s</span><span class="mclose">)</span><span class="mclose">]</span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Q</mi><mo>(</mo><mn>1</mn><mo separator="true">,</mo><mn>5</mn><mo>)</mo><mo>=</mo><mi>R</mi><mo>(</mo><mn>1</mn><mo separator="true">,</mo><mn>5</mn><mo>)</mo><mo>+</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>8</mn><mo>&#xD7;</mo><mi>M</mi><mi>a</mi><mi>x</mi><mo>[</mo><mi>Q</mi><mo>(</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo>)</mo><mo separator="true">,</mo><mi>Q</mi><mo>(</mo><mn>1</mn><mo separator="true">,</mo><mn>5</mn><mo>)</mo><mo>]</mo><mo>=</mo><mn>0</mn><mo>+</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>8</mn><mo>&#xD7;</mo><mi>M</mi><mi>a</mi><mi>x</mi><mo>(</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mn>0</mn><mn>0</mn><mo>)</mo><mo>=</mo><mn>8</mn><mn>0</mn></mrow><annotation encoding="application/x-tex">Q(1, 5) = R(1, 5) + 0.8 \times Max[Q(1, 2), Q(1, 5)] = 0 + 0.8 \times Max(0, 100) = 80</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">Q</span><span class="mopen">(</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord mathrm">5</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord mathrm">5</span><span class="mclose">)</span><span class="mbin">+</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">8</span><span class="mbin">&#xD7;</span><span class="mord mathit" style="margin-right:0.10903em;">M</span><span class="mord mathit">a</span><span class="mord mathit">x</span><span class="mopen">[</span><span class="mord mathit">Q</span><span class="mopen">(</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord mathrm">2</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mord mathit">Q</span><span class="mopen">(</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord mathrm">5</span><span class="mclose">)</span><span class="mclose">]</span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mbin">+</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">8</span><span class="mbin">&#xD7;</span><span class="mord mathit" style="margin-right:0.10903em;">M</span><span class="mord mathit">a</span><span class="mord mathit">x</span><span class="mopen">(</span><span class="mord mathrm">0</span><span class="mpunct">,</span><span class="mord mathrm">1</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathrm">8</span><span class="mord mathrm">0</span></span></span></span></p>
<p>We use the updated matrix Q from the last episode.  Q(1, 3) = 0 and Q(1, 5) = 100.  The result of the computation is Q(3, 1) = 80 because the reward is zero.  The matrix Q becomes:</p>
<p><img src="q_matrix3.gif" alt="image.png"></p>
<p>The next state, 1, now becomes the current state.  We repeat the inner loop of the Q learning algorithm because state 1 is not the goal state.</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Q</mi><mo>(</mo><mi>s</mi><mi>t</mi><mi>a</mi><mi>t</mi><mi>e</mi><mo separator="true">,</mo><mi>a</mi><mi>c</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo>)</mo><mo>=</mo><mi>R</mi><mo>(</mo><mi>s</mi><mi>t</mi><mi>a</mi><mi>t</mi><mi>e</mi><mo separator="true">,</mo><mi>a</mi><mi>c</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo>)</mo><mo>+</mo><mi>&#x3B3;</mi><mo>&#xD7;</mo><mi>M</mi><mi>a</mi><mi>x</mi><mo>[</mo><mi>Q</mi><mo>(</mo><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi><mi>s</mi><mi>t</mi><mi>a</mi><mi>t</mi><mi>e</mi><mo separator="true">,</mo><mi>a</mi><mi>l</mi><mi>l</mi><mi>a</mi><mi>c</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mi>s</mi><mo>)</mo><mo>]</mo></mrow><annotation encoding="application/x-tex">Q(state, action) = R(state, action) + \gamma \times Max[Q(next state, all actions)]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">Q</span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mord mathit">t</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">e</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mord mathit">c</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathit">n</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mord mathit">t</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">e</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mord mathit">c</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathit">n</span><span class="mclose">)</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.05556em;">&#x3B3;</span><span class="mbin">&#xD7;</span><span class="mord mathit" style="margin-right:0.10903em;">M</span><span class="mord mathit">a</span><span class="mord mathit">x</span><span class="mopen">[</span><span class="mord mathit">Q</span><span class="mopen">(</span><span class="mord mathit">n</span><span class="mord mathit">e</span><span class="mord mathit">x</span><span class="mord mathit">t</span><span class="mord mathit">s</span><span class="mord mathit">t</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">e</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">a</span><span class="mord mathit">c</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathit">n</span><span class="mord mathit">s</span><span class="mclose">)</span><span class="mclose">]</span></span></span></span></p>
<p>Algorithm to utilize the Q matrix:</p>
<ol>
<li><p>Set current state = initial state.</p>
</li>
<li><p>From current state, find the action with the highest Q value.</p>
</li>
<li><p>Set current state = next state.</p>
</li>
<li><p>Repeat Steps 2 and 3 until current state = goal state.</p>
</li>
</ol>
<p>The algorithm above will return the sequence of states from the initial state to the goal state.</p>
<h1 id="&#x591A;&#x6B21;&#x8FD0;&#x884C;&#x4E0B;&#x9762;&#x7684;cell&#x53EF;&#x4EE5;&#x770B;&#x6BCF;&#x6B21;&#x8FED;&#x4EE3;&#x6240;&#x5F97;&#x5230;&#x7684;q&#x8868;&#x66F4;&#x65B0;&#x6548;&#x679C;">&#x591A;&#x6B21;&#x8FD0;&#x884C;&#x4E0B;&#x9762;&#x7684;cell&#x53EF;&#x4EE5;&#x770B;&#x6BCF;&#x6B21;&#x8FED;&#x4EE3;&#x6240;&#x5F97;&#x5230;&#x7684;Q&#x8868;&#x66F4;&#x65B0;&#x6548;&#x679C;</h1>
<p>&#x91C7;&#x53D6;&#x7684;&#x66F4;&#x65B0;&#x65B9;&#x6848;&#x4E3A;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3F5;</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">&#x3F5;</span></span></span></span>-greedy,&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8C03;&#x6574;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3F5;</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">&#x3F5;</span></span></span></span>&#x5B9E;&#x73B0;&#x6216;&#x4E0A;&#x9762;&#x7684;greedy&#xFF0C;&#x6216;&#x968F;&#x673A;&#x91C7;&#x6837;&#x3002;</p>
<p>For epoch in max_epoches:</p>
<ol>
<li>&#x968F;&#x673A;&#x9009;&#x53D6;&#x4E00;&#x4E2A;state</li>
<li>&#x5728;&#x9009;&#x53D6;&#x7684;state&#x4E0B;&#x9009;&#x5B9A;&#x4E00;&#x4E2A;&#x53EF;&#x884C;&#x7684;&#x52A8;&#x4F5C;&#xFF08;&#x5728;&#x672C;&#x4F8B;&#x4E2D;&#xFF0C;&#x4E0D;&#x53EF;&#x884C;&#x7684;&#x52A8;&#x4F5C;&#x56DE;&#x62A5;&#x4E3A;&quot;-1&quot;)</li>
<li>&#x6309;&#x7167;&#x516C;&#x5F0F; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Q</mi><mo>(</mo><mi>s</mi><mi>t</mi><mi>a</mi><mi>t</mi><mi>e</mi><mo separator="true">,</mo><mi>a</mi><mi>c</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo>)</mo><mo>=</mo><mi>R</mi><mo>(</mo><mi>s</mi><mi>t</mi><mi>a</mi><mi>t</mi><mi>e</mi><mo separator="true">,</mo><mi>a</mi><mi>c</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo>)</mo><mo>+</mo><mi>&#x3B3;</mi><mo>&#xD7;</mo><mi>M</mi><mi>a</mi><mi>x</mi><mo>[</mo><mi>Q</mi><mo>(</mo><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi><mi>s</mi><mi>t</mi><mi>a</mi><mi>t</mi><mi>e</mi><mo separator="true">,</mo><mi>a</mi><mi>l</mi><mi>l</mi><mi>a</mi><mi>c</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mi>s</mi><mo>)</mo><mo>]</mo></mrow><annotation encoding="application/x-tex">Q(state, action) = R(state, action) + \gamma \times Max[Q(next state, all actions)]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">Q</span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mord mathit">t</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">e</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mord mathit">c</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathit">n</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mord mathit">t</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">e</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mord mathit">c</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathit">n</span><span class="mclose">)</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.05556em;">&#x3B3;</span><span class="mbin">&#xD7;</span><span class="mord mathit" style="margin-right:0.10903em;">M</span><span class="mord mathit">a</span><span class="mord mathit">x</span><span class="mopen">[</span><span class="mord mathit">Q</span><span class="mopen">(</span><span class="mord mathit">n</span><span class="mord mathit">e</span><span class="mord mathit">x</span><span class="mord mathit">t</span><span class="mord mathit">s</span><span class="mord mathit">t</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">e</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">a</span><span class="mord mathit">c</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathit">n</span><span class="mord mathit">s</span><span class="mclose">)</span><span class="mclose">]</span></span></span></span>&#x8BA1;&#x7B97;Q&#x503C;</li>
<li>&#x91C7;&#x53D6;2&#x4E2D;&#x9009;&#x5B9A;&#x7684;&#x52A8;&#x4F5C;&#xFF0C;&#x5C06;state&#x66F4;&#x65B0;&#x5230;&#x4E0B;&#x4E00;&#x4E2A;state</li>
<li>&#x5982;&#x679C;&#x8FD0;&#x52A8;&#x5230;&#x7EC8;&#x70B9;&#x5219;&#x4E2D;&#x65AD;</li>
</ol>
<p>End For</p>
<h1 id="&#x9009;&#x53D6;&#x4E0B;&#x4E2A;&#x52A8;&#x4F5C;&#x7684;&#x65B9;&#x6CD5;&#xFF1A;greedy&#x3001;random&#x3001;epsilon-greedy">&#x9009;&#x53D6;&#x4E0B;&#x4E2A;&#x52A8;&#x4F5C;&#x7684;&#x65B9;&#x6CD5;&#xFF1A;greedy&#x3001;random&#x3001;$\epsilon$-greedy</h1>
<p>&#x4EE5;\epsilon&#x6982;&#x7387;&#x91C7;&#x53D6;&#x8D2A;&#x5FC3;&#x7B97;&#x6CD5;</p>
<ul>
<li>\epsilon = 1: &#x8D2A;&#x5FC3;</li>
<li>\epsilon = 0: &#x968F;&#x673A;</li>
</ul>
<pre><code class="lang-python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">randomly_select_act</span><span class="hljs-params">(state)</span>:</span>
    <span class="hljs-comment"># &#x968F;&#x673A;&#x9009;&#x5B9A;&#x4E00;&#x4E2A;&#x6B63;&#x56DE;&#x62A5;&#x7684;&#x52A8;&#x4F5C;</span>
    flag = <span class="hljs-keyword">True</span>
    <span class="hljs-keyword">while</span> flag:
        action = np.random.randint(<span class="hljs-number">0</span>, <span class="hljs-number">6</span>)
        <span class="hljs-keyword">if</span> r[state, action] &gt;= <span class="hljs-number">0</span>:
            flag = <span class="hljs-keyword">False</span>
    <span class="hljs-keyword">return</span> action

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">greedly_select_act</span><span class="hljs-params">(state)</span>:</span>
    <span class="hljs-comment"># &#x8D2A;&#x5FC3;&#x9009;&#x53D6;&#x4E0B;&#x4E2A;&#x52A8;&#x4F5C;</span>
    actions = list(q[state, :])
    max_q = max(actions)
    max_actioin_index = list()
    <span class="hljs-keyword">for</span> i, act <span class="hljs-keyword">in</span> enumerate(actions):
        <span class="hljs-keyword">if</span> act &gt;= max_q:
            max_actioin_index.append(i)
    <span class="hljs-keyword">return</span> random.sample(max_actioin_index, <span class="hljs-number">1</span>)[<span class="hljs-number">0</span>]

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">e_greedy</span><span class="hljs-params">(state, e)</span>:</span>
    <span class="hljs-keyword">if</span> random.random() &lt; e:
        <span class="hljs-keyword">return</span> greedly_select_act(state)
    <span class="hljs-keyword">else</span>:
        <span class="hljs-keyword">return</span> randomly_select_act(state)
</code></pre>
<p>For the next episode, we start with a randomly chosen initial state.  This time, we have state 3 as our initial state.</p>
<p>Look at the fourth row of matrix R; it has 3 possible actions: go to state 1, 2 or 4.  By random selection, we select to go to state 1 as our action.</p>
<p>Now we imagine that we are in state 1.  Look at the second row of reward matrix R (i.e. state 1).  It has 2 possible actions: go to state 3 or state 5.  Then, we compute the Q value:</p>
<p><strong>&#x8DDD;&#x79BB;&#x7EC8;&#x70B9;&#x5F88;&#x8FD1;&#xFF0C;Max[Q(next state, all actions)]&#x5C31;&#x4F1A;&#x5F88;&#x5927;</strong></p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Q</mi><mo>(</mo><mi>s</mi><mi>t</mi><mi>a</mi><mi>t</mi><mi>e</mi><mo separator="true">,</mo><mi>a</mi><mi>c</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo>)</mo><mo>=</mo><mi>R</mi><mo>(</mo><mi>s</mi><mi>t</mi><mi>a</mi><mi>t</mi><mi>e</mi><mo separator="true">,</mo><mi>a</mi><mi>c</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo>)</mo><mo>+</mo><mi>&#x3B3;</mi><mo>&#xD7;</mo><mi>M</mi><mi>a</mi><mi>x</mi><mo>[</mo><mi>Q</mi><mo>(</mo><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi><mi>s</mi><mi>t</mi><mi>a</mi><mi>t</mi><mi>e</mi><mo separator="true">,</mo><mi>a</mi><mi>l</mi><mi>l</mi><mi>a</mi><mi>c</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mi>s</mi><mo>)</mo><mo>]</mo></mrow><annotation encoding="application/x-tex">Q(state, action) = R(state, action) + \gamma \times Max[Q(next state, all actions)]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">Q</span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mord mathit">t</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">e</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mord mathit">c</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathit">n</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mord mathit">t</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">e</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mord mathit">c</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathit">n</span><span class="mclose">)</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.05556em;">&#x3B3;</span><span class="mbin">&#xD7;</span><span class="mord mathit" style="margin-right:0.10903em;">M</span><span class="mord mathit">a</span><span class="mord mathit">x</span><span class="mopen">[</span><span class="mord mathit">Q</span><span class="mopen">(</span><span class="mord mathit">n</span><span class="mord mathit">e</span><span class="mord mathit">x</span><span class="mord mathit">t</span><span class="mord mathit">s</span><span class="mord mathit">t</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">e</span><span class="mpunct">,</span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">a</span><span class="mord mathit">c</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathit">n</span><span class="mord mathit">s</span><span class="mclose">)</span><span class="mclose">]</span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Q</mi><mo>(</mo><mn>1</mn><mo separator="true">,</mo><mn>5</mn><mo>)</mo><mo>=</mo><mi>R</mi><mo>(</mo><mn>1</mn><mo separator="true">,</mo><mn>5</mn><mo>)</mo><mo>+</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>8</mn><mo>&#xD7;</mo><mi>M</mi><mi>a</mi><mi>x</mi><mo>[</mo><mi>Q</mi><mo>(</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo>)</mo><mo separator="true">,</mo><mi>Q</mi><mo>(</mo><mn>1</mn><mo separator="true">,</mo><mn>5</mn><mo>)</mo><mo>]</mo><mo>=</mo><mn>0</mn><mo>+</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>8</mn><mo>&#xD7;</mo><mi>M</mi><mi>a</mi><mi>x</mi><mo>(</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mn>0</mn><mn>0</mn><mo>)</mo><mo>=</mo><mn>8</mn><mn>0</mn></mrow><annotation encoding="application/x-tex">Q(1, 5) = R(1, 5) + 0.8 \times Max[Q(1, 2), Q(1, 5)] = 0 + 0.8 \times Max(0, 100) = 80</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">Q</span><span class="mopen">(</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord mathrm">5</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord mathrm">5</span><span class="mclose">)</span><span class="mbin">+</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">8</span><span class="mbin">&#xD7;</span><span class="mord mathit" style="margin-right:0.10903em;">M</span><span class="mord mathit">a</span><span class="mord mathit">x</span><span class="mopen">[</span><span class="mord mathit">Q</span><span class="mopen">(</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord mathrm">2</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mord mathit">Q</span><span class="mopen">(</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord mathrm">5</span><span class="mclose">)</span><span class="mclose">]</span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mbin">+</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">8</span><span class="mbin">&#xD7;</span><span class="mord mathit" style="margin-right:0.10903em;">M</span><span class="mord mathit">a</span><span class="mord mathit">x</span><span class="mopen">(</span><span class="mord mathrm">0</span><span class="mpunct">,</span><span class="mord mathrm">1</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathrm">8</span><span class="mord mathrm">0</span></span></span></span></p>
<p>We use the updated matrix Q from the last episode.  Q(1, 3) = 0 and Q(1, 5) = 100.  The result of the computation is Q(3, 1) = 80 because the reward is zero.  The matrix Q becomes:</p>
<p><img src="q_matrix3.gif" alt="image.png"></p>
<h1 id="&#x4E00;&#x4E2A;episode&#xFF1A;">&#x4E00;&#x4E2A;episode&#xFF1A;</h1>
<pre><code class="lang-python">epsilon = <span class="hljs-number">1</span>
print(<span class="hljs-string">&apos;&#x3F5;:&apos;</span>, epsilon)

print(<span class="hljs-string">&quot;&#x672C;&#x6B21;epoch&#x8FD0;&#x52A8;&#x8DEF;&#x5F84;&#xFF1A;&quot;</span>)
state = np.random.randint(<span class="hljs-number">0</span>,<span class="hljs-number">6</span>)

<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">200</span>):
    print(state, end=<span class="hljs-string">&apos;, &apos;</span>)
    <span class="hljs-keyword">if</span> state == <span class="hljs-number">5</span>:
        <span class="hljs-keyword">break</span>
    action = e_greedy(state, epsilon)
    action = randomly_select_act(state)

    q[state, action] = round(r[state, action] + gamma * max(q[action, :]))
    state = action

<span class="hljs-comment"># &#x4E00;&#x4E2A;episode&#xFF1A;</span>
print(<span class="hljs-string">&apos;\n&apos;</span>,q)
</code></pre>
<pre><code>&#x3F5;: 1
&#x672C;&#x6B21;epoch&#x8FD0;&#x52A8;&#x8DEF;&#x5F84;&#xFF1A;
5, 
 [[   0.    0.    0.    0.   80.    0.]
 [   0.    0.    0.   64.    0.  100.]
 [   0.    0.    0.   64.    0.    0.]
 [   0.   80.   51.    0.   80.    0.]
 [  64.    0.    0.   64.    0.  100.]
 [   0.    0.    0.    0.    0.    0.]]
</code></pre><h1 id="&#x4F7F;&#x7528;&#x8BAD;&#x7EC3;&#x5F97;&#x5230;&#x7684;q&#x8868;&#x89E3;&#x9898;&#xFF1A;">&#x4F7F;&#x7528;&#x8BAD;&#x7EC3;&#x5F97;&#x5230;&#x7684;Q&#x8868;&#x89E3;&#x9898;&#xFF1A;</h1>
<pre><code class="lang-python">state = input(<span class="hljs-string">&apos;&#x8BF7;&#x8F93;&#x5165;&#x6574;&#x6570;&#x521D;&#x59CB;&#x72B6;&#x6001;&#xFF08;0-5&#xFF09;&#xFF1A;&apos;</span>)
<span class="hljs-keyword">assert</span> int(state) &gt;= <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> int(state) &lt;= <span class="hljs-number">5</span>, <span class="hljs-string">&apos;&#x8BF7;&#x8F93;&#x5165;&#x6574;&#x6570;&#x521D;&#x59CB;&#x72B6;&#x6001;&#xFF08;0-5&#xFF09;&apos;</span>
state = int(state)
print(<span class="hljs-string">&apos;&#x884C;&#x8D70;&#x8DEF;&#x5F84;&#x4E3A;&#xFF1A;&apos;</span>)
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">200</span>):
    print(state, end=<span class="hljs-string">&apos;, &apos;</span>)
    <span class="hljs-keyword">if</span> state == <span class="hljs-number">5</span>:
        <span class="hljs-keyword">break</span>
    action = greedly_select_act(state)
    state = action
</code></pre>
<pre><code>&#x8BF7;&#x8F93;&#x5165;&#x6574;&#x6570;&#x521D;&#x59CB;&#x72B6;&#x6001;&#xFF08;0-5&#xFF09;&#xFF1A;2
&#x884C;&#x8D70;&#x8DEF;&#x5F84;&#x4E3A;&#xFF1A;
2, 3, 1, 5, 
</code></pre><h1 id="&#x5730;&#x56FE;&#xFF1A;">&#x5730;&#x56FE;&#xFF1A;</h1>
<p><img src="modeling_environment_clip_image002a.gif" alt="image.png"></p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="OU-process.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page: OU Process">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Step By Step Q Learning","level":"1.4.1.1.4","depth":4,"next":{"title":"Neural Network","level":"1.4.1.2","depth":3,"ref":"","articles":[{"title":"nn_mnist_static.py","level":"1.4.1.2.1","depth":4,"path":"A2-Machine_Learning/Algorithms/NeuralNetwork/nn_mnist_static.py.md","ref":"A2-Machine_Learning/Algorithms/NeuralNetwork/nn_mnist_static.py.md","articles":[]},{"title":"nn_mnist.py","level":"1.4.1.2.2","depth":4,"path":"A2-Machine_Learning/Algorithms/NeuralNetwork/nn_mnist.py.md","ref":"A2-Machine_Learning/Algorithms/NeuralNetwork/nn_mnist.py.md","articles":[]}]},"previous":{"title":"OU Process","level":"1.4.1.1.3","depth":4,"path":"A2-Machine_Learning/Algorithms/Deep_Reinforcement_Learning/OU-process.md","ref":"A2-Machine_Learning/Algorithms/Deep_Reinforcement_Learning/OU-process.md","articles":[]},"dir":"ltr"},"config":{"plugins":["katex","copy-code-button","graphviz@git+https://github.com/darvasd/gitbook-plugin-graphviz.git","disqus","expandable-chapters"],"ignores":["_book","node_modules"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"disqus":{"useIdentifier":false,"shortName":"notes-pythonic-life"},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"katex":{},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"graphviz":{"format":"svg"},"copy-code-button":{},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"expandable-chapters":{}},"theme":"default","author":"Charles Xu","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"SimSun","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"CharlesNotes","graphviz":{"format":"svg","engine":"dot"},"gitbook":"*"},"file":{"path":"A2-Machine_Learning/Algorithms/Deep_Reinforcement_Learning/step by step q learning.md","mtime":"2021-06-30T08:18:19.899Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2021-06-30T08:20:42.364Z"},"basePath":"../../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../../gitbook/gitbook.js"></script>
    <script src="../../../gitbook/theme.js"></script>
    
        
        <script src="../../../gitbook/gitbook-plugin-copy-code-button/toggle.js"></script>
        
    
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/URI.js/1.16.1/URI.min.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-disqus/plugin.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

